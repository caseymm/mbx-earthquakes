{"version":3,"sources":["App.js","index.js"],"names":["mapboxgl","accessToken","Legend","array","i","push","className","map","num","style","backgroundColor","interpolateYlOrRd","App","React","PureComponent","constructor","props","super","this","state","lng","lat","zoom","mapContainer","createRef","componentDidMount","loaded","Map","container","current","center","params","window","location","search","slice","split","p","reduce","obj","key","value","console","log","postDiv","Div","document","createElement","id","getElementsByClassName","appendChild","featureTypes","queryRenderedFeatures","f","sourceLayer","uniqueFeats","Set","index","indexOf","undefined","splice","length","getMapFeatures","setTimeout","reload","async","resp","fetch","url","json","loadData","then","features","filter","properties","PARAMVALUE","forEach","color","addSource","type","data","addLayer","source","layout","paint","property","bounds","turf","fitBounds","padding","duration","render","ref","ReactDOM","StrictMode","getElementById"],"mappings":"uNAMAA,IAASC,YACL,iGAGJ,MAAMC,EAAS,KACb,IAAIC,EAAQ,GACZ,IAAI,IAAIC,EAAI,IAAKA,EAAI,EAAGA,GAAK,IAC3BD,EAAME,KAAKD,GAGb,OACE,sBAAKE,UAAU,gBAAf,UACE,qBAAKA,UAAU,SAAf,SACGH,EAAMI,KAAIC,GACT,qBAAyBF,UAAY,SAAQE,IAAOC,MAAO,CAACC,gBAAiBC,YAA8B,eAAXH,EAAM,QAA3F,QAAOA,SAGtB,sBAAKF,UAAU,SAAf,UACE,qBAAKA,UAAU,OAAf,mCACA,qBAAKA,UAAU,WAAf,sBACA,qBAAKA,UAAU,cAAf,yBACA,qBAAKA,UAAU,UAAf,4BAMO,MAAMM,UAAYC,IAAMC,cACrCC,YAAYC,GACVC,MAAMD,GACNE,KAAKC,MAAQ,CACXC,KAAM,kBACNC,IAAK,kBACLC,KAAM,KAERJ,KAAKK,aAAeV,IAAMW,YAG5BC,oBACE,MAAM,IAAEL,EAAF,IAAOC,EAAP,KAAYC,GAASJ,KAAKC,MAChC,IAAIO,GAAS,EACb,MAAMnB,EAAM,IAAIP,IAAS2B,IAAI,CAC3BC,UAAWV,KAAKK,aAAaM,QAC7BpB,MAAO,wDACPqB,OAAQ,CAACV,EAAKC,GACdC,KAAMA,IAGFS,EAASC,OAAOC,SAASC,OAC9BC,MAAM,GACNC,MAAM,KACN7B,KAAK8B,GAAMA,EAAED,MAAM,OACnBE,QAAO,CAACC,GAAMC,EAAKC,MAAZ,IAA6BF,EAAK,CAACC,GAAMC,KAAU,IAE3DC,QAAQC,IAAIZ,GAEZ,MAcMa,EAAU,KACdF,QAAQC,IAAI,UAEZ,MAAME,EAAMC,SAASC,cAAc,OACnCF,EAAIG,GAAK,SACTF,SAASG,uBAAuB,iBAAiB,GAAGC,YAAYL,GAnB3C,MAGrB,IAAIM,EADgB5C,EAAI6C,wBACO7C,KAAI8C,GAAKA,EAAEC,cACtCC,EAAc,IAAI,IAAIC,IAAIL,IAC9B,MAAMM,EAAQF,EAAYG,aAAQC,GAC9BF,GAAS,GACXF,EAAYK,OAAOH,EAAO,GAEF,IAAvBF,EAAYM,QAAmC,UAAnBN,EAAY,IACzCb,QAAQC,IAAI,cAUdmB,IAGFC,YAAW,WACLrC,GACFM,OAAOC,SAAS+B,WAEjB,KAEHC,iBACE,MAAMC,QAAaC,MAAMpC,EAAOqC,KAEhC,aADmBF,EAAKG,OAI1BC,GAAWC,MAAKF,IAEd3B,QAAQC,IAAI,YACZ0B,EAAKG,SAAWH,EAAKG,SAASC,QAAOpB,GAAKA,EAAEqB,WAAWC,WAAa,MACpEN,EAAKG,SAASI,SAAQvB,IAEpBA,EAAEqB,WAAWG,MAAQlE,YAAqD,eAAV,GAAxB0C,EAAEqB,WAAWC,WAAgB,SAGvEjD,GAAS,EACTnB,EAAIuE,UAAU,YAAa,CACzBC,KAAM,UACNC,KAAMX,IAIR9D,EAAI0E,SAAS,CACXjC,GAAI,kBACJ+B,KAAM,OACNG,OAAQ,YACRC,OAAQ,GACRC,MAAO,CAEL,aAAc,CACVL,KAAM,WACNM,SAAU,SAEd,eAAgB,IAEjB,SAGH,MAAMC,EAASC,OAAUlB,GACzB9D,EAAIiF,UAAUF,EAAQ,CAAEG,QAAS,EAAGC,SAAU,IAC9C3B,YAAW,WACTnB,MACC,QAKP+C,SACE,OACE,gCACE,qBAAKC,IAAK1E,KAAKK,aAAcjB,UAAU,kBACvC,cAACJ,EAAD,QCxIR2F,IAASF,OACT,cAAC,IAAMG,WAAP,UACA,cAAC,EAAD,MAEAhD,SAASiD,eAAe,U","file":"static/js/main.89450af4.chunk.js","sourcesContent":["import React from 'react';\nimport './index.css';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\nimport * as turf from '@turf/turf';\nimport {interpolateYlOrRd} from 'd3-scale-chromatic';\n\nmapboxgl.accessToken =\n    'pk.eyJ1IjoiY2FzZXltbWlsZXIiLCJhIjoiY2lpeHY1bnJ1MDAyOHVkbHpucnB1dGRmbyJ9.TzUoCLwyeDoLjh3tkDSD4w';\n\n\nconst Legend = () => {\n  let array = []\n  for(let i = .15; i < 1; i += .01){\n    array.push(i);\n  }\n\n  return(\n    <div className=\"legend-holder\">\n      <div className=\"legend\">\n        {array.map(num => (\n          <div key={`item-${num}`} className={`color ${num}`} style={{backgroundColor: interpolateYlOrRd((num - .15)*1.17647058823)}}></div>\n        ))}\n      </div>\n      <div className=\"labels\">\n        <div className=\"weak\">weak to light shaking</div>\n        <div className=\"moderate\">moderate</div>\n        <div className=\"very-strong\">very strong</div>\n        <div className=\"violent\">violent</div>\n      </div>\n    </div>\n  );\n}\n\nexport default class App extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lng: -98.78320225360663,\n      lat: 40.45646421496375, \n      zoom: 3.5\n    };\n    this.mapContainer = React.createRef();\n  }\n\n  componentDidMount() {\n    const { lng, lat, zoom } = this.state;\n    let loaded = false;\n    const map = new mapboxgl.Map({\n      container: this.mapContainer.current,\n      style: 'mapbox://styles/caseymmiler/cku5y4h6e321517pqp2dtwj1w',\n      center: [lng, lat],\n      zoom: zoom\n    });\n    \n    const params = window.location.search\n    .slice(1)\n    .split('&')\n    .map((p) => p.split('='))\n    .reduce((obj, [key, value]) => ({ ...obj, [key]: value }), {});\n\n    console.log(params);\n\n    const getMapFeatures = () => {\n      // don't want to tweet blank maps of the ocean\n      const mapFeatures = map.queryRenderedFeatures();\n      let featureTypes = mapFeatures.map(f => f.sourceLayer);\n      let uniqueFeats = [...new Set(featureTypes)];\n      const index = uniqueFeats.indexOf(undefined);\n      if (index > -1) {\n        uniqueFeats.splice(index, 1); // 2nd parameter means remove one item only\n      }\n      if(uniqueFeats.length === 1 && uniqueFeats[0] === 'water'){\n        console.log('blank map');\n      }\n    }\n\n    const postDiv = () => {\n      console.log('loaded')\n      // signal done\n      const Div = document.createElement('div');\n      Div.id = 'hidden';\n      document.getElementsByClassName('map-container')[0].appendChild(Div);\n      getMapFeatures();\n    }\n\n    setTimeout(function(){\n      if(!loaded){\n        window.location.reload();\n      }\n    }, 3000)\n\n    async function loadData() {\n      const resp = await fetch(params.url);\n      const json = await resp.json();\n      return json;\n    }\n\n    loadData().then(json => {\n      // map.on('load', function () {\n      console.log('ran load')\n      json.features = json.features.filter(f => f.properties.PARAMVALUE > 1.5);\n      json.features.forEach(f => {\n        // console.log(f.properties.PARAMVALUE*.1, (f.properties.PARAMVALUE*.1 - .15)*1.17647058823)\n        f.properties.color = interpolateYlOrRd((f.properties.PARAMVALUE*.1 - .15)*1.17647058823);\n      })\n\n      loaded = true;\n      map.addSource('data-json', {\n        type: 'geojson',\n        data: json,\n      });\n\n      // Add a new layer to visualize the polygon.\n      map.addLayer({\n        id: 'data-json-layer',\n        type: 'fill',\n        source: 'data-json', // reference the data source\n        layout: {},\n        paint: {\n          // needs to assign fill color based on value\n          'fill-color': {\n              type: 'identity',\n              property: 'color',\n          },\n          'fill-opacity': 1\n        },\n      }, 'water');\n      // 'settlement-minor-label'\n    \n      const bounds = turf.bbox(json);\n      map.fitBounds(bounds, { padding: 0, duration: 0 });\n      setTimeout(function(){\n        postDiv();\n      }, 5000)\n    });\n    // });\n  }\n\n  render() {\n    return (\n      <div>\n        <div ref={this.mapContainer} className=\"map-container\" />\n        <Legend />\n      </div>\n    );\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport './index.css';\nimport App from './App';\n \nReactDOM.render(\n<React.StrictMode>\n<App />\n</React.StrictMode>,\ndocument.getElementById('root')\n);"],"sourceRoot":""}